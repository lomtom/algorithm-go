---
title: 有效的正方形
categories:
  - 中等
tags:
  - 数学
number: 593
slug: valid-square
---

## 题目描述：

 给定2D空间中四个点的坐标 p1, p2, p3 和 p4，如果这四个点构成一个正方形，则返回 true 。

点的坐标 pi 表示为 [xi, yi] 。输入 不是 按任何顺序给出的。

 一个 有效的正方形 有四条等边和四个等角(90度角)。


**测试用例：**



示例 1:
```
输入: p1 = [0,0], p2 = [1,1], p3 = [1,0], p4 = [0,1]
输出: True
```

示例 2:
```
输入：p1 = [0,0], p2 = [1,1], p3 = [1,0], p4 = [0,12]
输出：false
```
示例 3:
```
输入：p1 = [1,0], p2 = [-1,0], p3 = [0,1], p4 = [0,-1]
输出：true
```

**限制及提示：**
- p1.length == p2.length == p3.length == p4.length == 2
- -10^4 <= xi, yi <= 10^4


---
## 解题分析及思路：

本题为数学问题，自然也是用数学方式来解答。

由正方形性质得出，某一点散发出来的三条边必然有两个边的平方和与第三条边的平方相同

根据某一点向其他三个点构成三条向量q1、q2、q3，以及他们之间的距离的平方s1、s2、s3

```go
q1 := []int{p1[0] - p2[0], p1[1] - p2[1]}
q2 := []int{p1[0] - p3[0], p1[1] - p3[1]}
q3 := []int{p1[0] - p4[0], p1[1] - p4[1]}

s1 := square(q1[0]) + square(q1[1])
s2 := square(q2[0]) + square(q2[1])
s3 := square(q3[0]) + square(q3[1])
```

以向量q1与q2为例，若这两条向量距离相等且和等于q3的距离和`s1 == s2 && s1+s2 == s3`，则q1可能与q2成相邻的两条边，注意这里还只是可能，因为其夹角未知。

所以需要算出其夹角，由于垂直定义可得，`q1[0]*q2[0] + q1[1]*q2[1] == 0`时，q1与q2才垂直，即c1等于0。

```go
c1 := q1[0]*q2[0] + q1[1]*q2[1]
c2 := q2[0]*q3[0] + q2[1]*q3[1]
c3 := q1[0]*q3[0] + q1[1]*q3[1]
```

此时还无法得出向量q3与q1，q2之间的关系。若此时p1和p2的形成的向量与p3和p4的形成的向量相等时，这四个点才形成正方形。即`p1[0]-p2[0] == p3[0]-p4[0] && p1[1]-p2[1] == p3[1]-p4[1]`


然而，这还只是一种情况，三个向量两两垂直的情况一共有三种，所以需要分别判断即可。
```go
if s1 == s2 && s1+s2 == s3 && c1 == 0 && p1[0]-p2[0] == p3[0]-p4[0] && p1[1]-p2[1] == p3[1]-p4[1] ||
    s2 == s3 && s2+s3 == s1 && c2 == 0 && p1[0]-p3[0] == p4[0]-p2[0] && p1[1]-p3[1] == p4[1]-p2[1] ||
    s1 == s3 && s1+s3 == s2 && c3 == 0 && p1[0]-p2[0] == p4[0]-p3[0] && p1[1]-p2[1] == p4[1]-p3[1] {
    return true
}
```

除此之外，需要排除四个点处于同一位置的情况
```go
if p1[0] == p2[0] && p2[0] == p3[0] && p3[0] == p4[0] && p1[1] == p2[1] && p2[1] == p3[1] && p3[1] == p4[1] {
    return false
}
```

**复杂度：**

- 时间复杂度：O(1)
- 空间复杂度：O(1)

**执行结果：**

- 执行用时：0 ms, 在所有 Go 提交中击败了100.00%的用户
- 内存消耗：2.1 MB, 在所有 Go 提交中击败了100.00%的用户
